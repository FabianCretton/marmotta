<!--
Web interface to manage External Data Sources

Author: Fabian Cretton - OverLOD Project - HES-SO Valais
-->
<html>
<head>
<!--###BEGIN_HEAD###-->
    <title>Referencer</title>
    <script type="text/javascript" src="../../webjars/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript" src="../../webjars/marmotta.js"></script>
    <script type="text/javascript" src="js/widgets/extDataSourcesClient.js"></script>
    <script type="text/javascript" src="js/widgets/extDataSourcesEditor.js"></script>
    <script type="text/javascript" src="js/widgets/extDataSourcesList.js"></script>
    <script type="text/javascript">
				var listEditor = null ; // object needed for the "refresh list" button
				
				function updateEDS(context, url)
				{
					if (!confirm('Are you sure you want to update the EDS with the current content of: ' + url)) {
						return ;
					}				
					
					//var loader =$("<img style='position: relative;top: 4px;margin-left: 10px;' src='../public/img/loader/ajax-loader_small.gif'>");
					//loader.show() ;
					$.ajax({
							url: '../EDSParams?context='+ encodeURIComponent(context),
							type: 'PUT',
							success: function(result) {
									alert("UPDATING in progress: upload is running; you can control the running import tasks on $LMF/core/admin/tasks.html");
							},
             error: function (jqXhr, textStatus, error) {
									alert("ERROR updating EDS (" + jqXhr.statusText + ": " + jqXhr.responseText + ")");
						}
					});
					
					//loader.hide() ;
				}
				
				function deleteEDS(context)
				{
					if (!confirm('Are you sure you want to delete the following EDS and its context: ' + context)) {
						return ;
					}				
					
					$.ajax({
							// with 'DELETE', the query string parameters can't be passed as 'data'
							url: '../EDSParams?context=' + encodeURIComponent(context) + '&deleteGraph=true',
							type: 'DELETE',
							success: function(result) {
									alert(result) ;
									listEditor.buildList() ; // refresh the list of EDS
							},
             error: function (jqXhr, textStatus, error) {
									alert("ERROR deleting EDS (" + jqXhr.statusText + ": " + jqXhr.responseText + ")");
						}
					});
				}
				
				function checkEDS()
				{
				$.ajax({
							url: '../checkUpdates',
							type: 'GET',
							success: function(result) {
									alert(result) ;
							},
             error: function (jqXhr, textStatus, error) {
									alert("ERROR checkEDS EDS (" + jqXhr.status +'-' + jqXhr.statusText  + ": " + jqXhr.responseText + ")");
						}
					});
				}
				
        $(document).ready(function(){
						listEditor = new EDSList("EDSList_div",_SERVER_URL);
            var singleEDSEditor = new EDSEditor("EDSEditor_div",listEditor,_SERVER_URL);
            
        })
    </script>
    <style>
        .import_type {
            padding: 2px;
            cursor: pointer;
            font-weight: bold;
        }
        .importer_table {
            background-color: #eeeeee;
            padding: 10px;
            border: 1px solid gray;
            -webkit-border-radius: 3px;
            border-radius: 3px;
        }
    </style>
<!--###END_HEAD###-->
</head>
<body>
<!--###BEGIN_CONTENT###-->
<h1>OverLOD Referencer</h1>
<div id="EDSList_div"></div>
<button onclick="javascript:listEditor.buildList();">Refresh List</button> 
<button onclick="javascript:checkEDS();">checkEDS * test</button> 
<div id="EDSEditor_div"></div>
<!--###END_CONTENT###-->
</body>
</html>
